parameters:
  env(LANCOID_OPENTRACING_HOSTNAME): unknown
  env(LANCOID_OPENTRACING_AGENT_HOST): localhost
  env(LANCOID_OPENTRACING_AGENT_PORT): '6831'
  env(LANCOID_OPENTRACING_SAMPLER_CLASS): Jaeger\Sampler\ConstSampler
  env(LANCOID_OPENTRACING_SAMPLER_VALUE): 'true'
  env(LANCOID_OPENTRACING_PROJECT_NAME): 'default will be provided by extension (basename(kernel.project_dir))'
  env(LANCOID_OPENTRACING_RESPONSE_HEADER): 'true'
  env(LANCOID_OPENTRACING_DOCTRINE_FULL_STATEMENT): 'true'
  env(LANCOID_OPENTRACING_DOCTRINE_PARAMETERS): 'true'
  env(LANCOID_OPENTRACING_DOCTRINE_ROW_COUNT): 'false'
  env(LANCOID_OPENTRACING_DOCTRINE_USER): 'false'

  lancoid_opentracing.hostname: '%env(LANCOID_OPENTRACING_HOSTNAME)%'
  lancoid_opentracing.agent.host: '%env(LANCOID_OPENTRACING_AGENT_HOST)%'
  lancoid_opentracing.agent.port: '%env(LANCOID_OPENTRACING_AGENT_PORT)%'
  lancoid_opentracing.project.name: '%env(LANCOID_OPENTRACING_PROJECT_NAME)%'
  lancoid_opentracing.sampler.class: '%env(LANCOID_OPENTRACING_SAMPLER_CLASS)%'
  lancoid_opentracing.sampler.value: '%env(LANCOID_OPENTRACING_SAMPLER_VALUE)%'
  lancoid_opentracing.response.header: '%env(LANCOID_OPENTRACING_RESPONSE_HEADER)%'
  lancoid_opentracing.doctrine.tag_full_statement: '%env(LANCOID_OPENTRACING_DOCTRINE_FULL_STATEMENT)%'
  lancoid_opentracing.doctrine.tag_parameters: '%env(LANCOID_OPENTRACING_DOCTRINE_PARAMETERS)%'
  lancoid_opentracing.doctrine.tag_row_count: '%env(LANCOID_OPENTRACING_DOCTRINE_ROW_COUNT)%'
  lancoid_opentracing.doctrine.tag_user: '%env(LANCOID_OPENTRACING_DOCTRINE_USER)%'

services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  ### public service ###

  Lancoid\SymfonyJaegerBundle\Service\Tracing:
    class: Lancoid\SymfonyJaegerBundle\Service\TracingService
    public: true
  lancoid_opentracing:
    alias: Lancoid\SymfonyJaegerBundle\Service\Tracing
    public: true

  ### internals ###

  Lancoid\SymfonyJaegerBundle\Factory\SpanOptionsFactory:
    class: Lancoid\SymfonyJaegerBundle\Factory\RequestSpanOptionsFactory
    arguments:
      $kernelDebug: '%kernel.debug%'
      $kernelEnvironment: '%kernel.environment%'
      $hostName: '%lancoid_opentracing.hostname%'

  Lancoid\SymfonyJaegerBundle\Factory\AgentHostResolver:
    class: Lancoid\SymfonyJaegerBundle\Factory\DefaultAgentHostResolver

  Lancoid\SymfonyJaegerBundle\Internal\Opentracing:
    class: Lancoid\SymfonyJaegerBundle\Internal\CachedOpentracing
    arguments:
      $projectName: '%lancoid_opentracing.project.name%'
      $agentHost: '%lancoid_opentracing.agent.host%'
      $agentPort: '%lancoid_opentracing.agent.port%'
      $samplerClass: '%lancoid_opentracing.sampler.class%'
      $samplerValue: '%lancoid_opentracing.sampler.value%'

  Lancoid\SymfonyJaegerBundle\Internal\Persistence:
    class: Lancoid\SymfonyJaegerBundle\Internal\PersistenceService

  Lancoid\SymfonyJaegerBundle\Internal\Utility:
    class: Lancoid\SymfonyJaegerBundle\Internal\UtilityService

  Lancoid\SymfonyJaegerBundle\Internal\Decorator\RequestSpanning:
    class: Lancoid\SymfonyJaegerBundle\Internal\Decorator\RequestSpanningService

  ### event subscribers ###

  Lancoid\SymfonyJaegerBundle\EventListener\StartRootSpanSubscriber: ~
  Lancoid\SymfonyJaegerBundle\EventListener\FinishRootSpanSubscriber: ~
  Lancoid\SymfonyJaegerBundle\EventListener\StartControllerSpanSubscriber: ~
  Lancoid\SymfonyJaegerBundle\EventListener\FinishControllerSpanSubscriber:
    arguments:
      $returnTraceId: '%lancoid_opentracing.response.header%'
  Lancoid\SymfonyJaegerBundle\EventListener\StartCommandSpanSubscriber: ~
  Lancoid\SymfonyJaegerBundle\EventListener\FinishCommandSpanSubscriber: ~
  Lancoid\SymfonyJaegerBundle\EventListener\ExceptionLogSubscriber: ~

  ### jaeger ###

  Lancoid\SymfonyJaegerBundle\Factory\JaegerConfigFactory:
    class: Lancoid\SymfonyJaegerBundle\Factory\JaegerStaticConfigFactory

  Lancoid\SymfonyJaegerBundle\Factory\TracerFactory:
    class: Lancoid\SymfonyJaegerBundle\Factory\JaegerTracerFactory

  Lancoid\SymfonyJaegerBundle\Internal\TracingId:
    class: Lancoid\SymfonyJaegerBundle\Internal\JaegerTracingId

  ### doctrine ###

  lancoid_opentracing.doctrine.dbal.connection_factory:
    class: Lancoid\SymfonyJaegerBundle\DBAL\TracingConnectionFactory
    decorates: doctrine.dbal.connection_factory
    arguments:
      $connectionFactory: '@lancoid_opentracing.doctrine.dbal.connection_factory.inner'

  Lancoid\SymfonyJaegerBundle\DBAL\SQLStatementFormatter:
    class: Lancoid\SymfonyJaegerBundle\DBAL\SQLStatementFormatterService

  Lancoid\SymfonyJaegerBundle\DBAL\SpanFactory:
    class: Lancoid\SymfonyJaegerBundle\DBAL\SQLSpanFactory
    arguments:
      $tagFullStatement: '%lancoid_opentracing.doctrine.tag_full_statement%'
      $tagParameters: '%lancoid_opentracing.doctrine.tag_parameters%'
      $tagRowCount: '%lancoid_opentracing.doctrine.tag_row_count%'
      $tagUser: '%lancoid_opentracing.doctrine.tag_user%'
